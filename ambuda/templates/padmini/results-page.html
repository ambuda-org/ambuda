{% extends "header-main-footer.html" %}
{% import "macros/components.html" as mc %}
{% import "padmini/macros.html" as m %}
{% from "padmini/x-settings-modal.html" import settings_modal %}
{% from "padmini/x-cheda-results.html" import cheda_card %}
{% from "padmini/constants.html" import dictionary_titles %}

{% block title %}{{ mc.title(_('Padmini')) }}{% endblock %}


{% block meta_description -%}
Our fast and simple dictionary tool supports six popular dictionaries in three
different languages.
{%- endblock %}


{# The dictionaries we expose through the Padmini interface. #}
{% set dictionaries = {
  "en": [
    ("apte", _("Apte (1890)")),
    ("mw", _('Monier-Williams (1899)')),
    ("shabdasagara", _('Shabdasagara (1900)')),
  ],
  "sa": [
    ("vacaspatyam", _('Vācaspatyam (1873)')),
    ("shabdakalpadruma", _('Śabdakalpadrumaḥ (1886)')),
  ],
  "koshas": [
    ("amara", _("Amarakosha")),
  ],
  "hi": [
    ("apte-sh", _("Apte Sanskrit-Hindi Kosh (1966)")),
  ],
  "kn": [
    ("shabdartha-kaustubha", _('Shabdarthakaustubha')),
  ],
} %}


{# A smaller query form at the top of the page. #}
{% macro results_bar(query) %}
<div class="flex justify-between items-baseline">
  <form class="flex-1 flex mb-8 mr-4 drop-shadow-sm" @submit.prevent="runQuery">
    {{ m.query_field(model="query", value=query) }}
    {{ m.query_button() }}
  </form>
  <div>
    {{ m.inline_settings_button() }}
  </div>
</div>
{% endmacro %}

{% block main %}
<article class="mx-4 md:mx-auto max-w-4xl mt-8">

<div x-data="padmini" class="mx-4 my-8">
  {{ results_bar(query) }}
  {{ settings_modal() }}

  {# better to have onClick on the x-data element, but doing so seems to break form submit. #}
  <div class="mt-8" @click="onClick">
  {% if cheda_results %}
    <section>
      <h2 class="font-bold text-2xl my-2">Analysis <span class="text-slate-300">(beta)</span></h2>
      {{ cheda_card(cheda_results) }}
    </section>
  {% else %}
    <section>
    <h2 class="font-bold text-2xl my-2">Meanings</h2>
      {% with query=query, entries=dict_results, dictionaries=dictionary_titles %}
        {% include "padmini/x-dictionary-results.html" %}
      {% endwith %}
    </section>
  {% endif %}
  </div>
</div>

</article>

<script type="text/javascript">
window.PADMINI_DEFAULTS = {{ js_defaults|safe }};
</script>
{% endblock %}
