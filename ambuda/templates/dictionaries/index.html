{% extends 'base-text.html' %}
{% import "macros/components.html" as mc %}
{% import 'macros/dictionaries.html' as m %}


{% block title %}{{ mc.title(_('Dictionaries')) }}{% endblock %}


{% block meta_description -%}
Our fast and simple dictionary toor supports six popular dictionaries in three
different languages.
{%- endblock %}


{% macro dictionary_form() %}
<form
    id="dict--form"
    class="mb-4"
    @submit.prevent="searchDictionary">
  <div class="flex mb-2">
    <input
        name="q"
        type="text"
        placeholder="{{ _('राम, ರಾಮ, rāma, rAma, ...') }}"
        class="p-2 flex-1 bg-zinc-100 rounded-tl rounded-bl"
        x-model="query"
    >
    </input>
    <input type="submit" value="{{ _('Search') }}"
        class="cursor-pointer btn-submit p-2 rounded-tr rounded-br"></input>
  </div>
  <select
      id="dict--version"
      name="version"
      class="text-sm bg-zinc-100
      text-zinc-400 hover:text-zinc-800 p-1"
      x-model="source"
      @change="updateSource">
    {% include "include/dict-options.html" %}
  </select>
  <select
      id="dict--script"
      class="text-sm bg-zinc-100 text-zinc-400 hover:text-zinc-800 p-1"
      x-model="uiScript"
      @change="updateScript">
    {% include 'include/script-options.html' %}
  </select>
</form>
{% endmacro %}


{% macro dictionary_history() %}
<div class="text-sm my-4 pb-2 border-b text-slate-500
     flex items-start justify-between"
     x-cloak x-show="history.length">
  <div class="flex flex-1 overflow-hidden">
    <h3 class="font-bold mb-2">{{ _('History:') }}</h3>
    <ul class="a-hover-underline flex">
      <template x-for="q in history.slice().reverse()">
        <li class="px-1">
          <a href="#" x-text="q" @click.prevent="searchFor(q)"></a>
        </li>
      </template>
    </ul>
  </div>
  <button class="btn btn-basic text-xs !p-0.5" @click.prevent="history = []">
    Clear
  </button>
</div>
{% endmacro %}


{% macro dictionary_response(query, entries) %}
<div id="dict--response">
{% if query or entries %}
  {% with query=query, entries=entries %}
    {% include "htmx/dictionary-results.html" %}
  {% endwith %}
{% else  %}
  {% include 'include/dictionary-help.html' %}
{% endif %}
</div>
{% endmacro %}


{% block content %}
<h1 class="text-xl font-bold my-4">{{ _('Dictionary lookup') }}</h1>

<div x-data="dictionary">
  {{ dictionary_form() }}
  {{ dictionary_history() }}
  {{ dictionary_response(query, entries) }}
</div>
{% endblock %}
